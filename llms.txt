## A Business Intelligence Toolkit for Financial Planning & Analysis (FP&A)

`fpaR` is a collection of business intelligence tools designed to
simplify common **financial planning and analysis (FP&A)** tasks such as
time intelligence calculations, customer, vendor or product
segmentation, and factor/variance analysis

The package is inspired by best practices from a collection of blogs,
books, industry research, and hands-on work experience, consolidating
frequently performed business analyses into a fast, efficient, and
reusable framework

In particular, the time intelligence functions are heavily inspired by
[PowerBI DAX](https://www.sqlbi.com/) functions

Under the hood, these functions are built upon the great foundations of:

- [dbplyr](https://dbplyr.tidyverse.org/)  
- [duckdb](https://github.com/duckdb/duckdb-r)
- [lubridate](https://lubridate.tidyverse.org/)

`fpaR` is designed to seamlessly work with either tibbles or modern
databases (DuckDB, Snowflake, SQLite, etc) with a unified syntax

Even if you are working with tibbles, most functions are optimized to
leverage [DuckDB](https://github.com/duckdb/duckdb-r) for superior speed
and performance.[¹](#fn1)

By default most `fpaR` function returns a lazy DBI object which you can
return as a tibble with
[`dplyr::collect()`](https://dplyr.tidyverse.org/reference/compute.html)

## Key features & benefits

- **Unified syntax** regardless if your data is in a tibble or a
  database
- **Scale** your data with [duckdb](https://github.com/duckdb/duckdb-r)
  to optimize your calculations
- **Instant clarity** as every function summarizes its transformation
  actions so that you can understand and validate the results

## Installation

Install the development version of `fpaR` from GitHub:

``` r
# Install using pak or install.package()

pak::pak("usrbinr/fpaR")
```

## What is in fpaR?

There are 3 main categories of functions:

- Time intelligence
- Segmentation strategies
- Factor analysis (work in progress)

### Datasets

> We recommend using the [Contoso](https://usrbinr.github.io/contoso/)
> package for any practice analysis. The contoso datasets are fictional
> business transaction of Contoso toy company which are helpful for
> business intelligence related analysis

### Time intelligence

`fpaR` provides readily available functions for most time intelligence
analysis such as
**Year-over-Year**([`yoy()`](https://usrbinr.github.io/fpaR/reference/yoy.md)),
**Month-to-Date**([`mtd()`](https://usrbinr.github.io/fpaR/reference/mtd.md)),
and **Current Year-to-Date over Previous Year-to-Date**
([`ytdopy()`](https://usrbinr.github.io/fpaR/reference/ytdopy.md))
analysis

These functions are designed to quickly answer most common time
intelligence related analysis in a consistent, fast and transparent way

**Key benefits:**

- **Auto-fill missing dates**: Ensures no missing periods in your
  datasets so that right period comparisons are performed

- **Flexible calendar options**: Handle comparisons based on a
  **standard** or **5-5-4** fiscal calendar to accommodate different
  reporting frameworks

- **Period imbalance indicator**: When comparing periods with dates
  imbalance, the time intelligence functions will alert you to the type
  and number of period imbalances to ensure you are aware of misleading
  likewise comparisons

Below is the full list of time intelligence functions:

| Function | Description                                    | Shift | Aggregate | Compare |
|----------|------------------------------------------------|-------|-----------|---------|
| YoY      | Full Year over Year                            |       |           | X       |
| YTD      | Year-to-Date                                   |       | X         |         |
| PYTD     | Prior Year-to-Date amount                      | X     | X         |         |
| YoYTD    | Current Year-to-Date over Prior Year-to-Date   | X     | X         | X       |
| YTDOPY   | Year-to-Date over Full Previous Year           | X     | X         | X       |
| QoQ      | Full Quarter over Quarter                      |       |           | X       |
| QTD      | Quarter-to-Date                                |       | X         |         |
| PQTD     | Prior Quarter-to-Date                          | X     | X         |         |
| QOQTD    | Quarter-over-Quarter-to-Date                   | X     | X         | X       |
| QTDOPQ   | Quarter-to-Date over Full Previous Quarter     | X     | X         | X       |
| MTD      | Month-to-Date                                  |       | X         |         |
| MoM      | Full Month over Full Month                     |       |           | X       |
| MoMTD    | Current Month-to-Date over Prior Month-to-Date | X     | X         | X       |
| PMTD     | Prior Month’s MTD amount                       | X     | X         |         |
| MTDOPM   | Month-to-Date over Full Previous Month         | X     | X         | X       |
| WTD      | Week-to-Date                                   |       | X         |         |
| WoW      | Full Week over Full Week                       |       |           | X       |
| WoWTD    | Current Week-to-Date over Prior Week-to-Date   | X     | X         | X       |
| PWTD     | Prior Week-to-Date                             | X     | X         |         |
| ATD      | cumlaitve total from inception to date         |       | x         |         |
| DoD      | Full Day over Full Day                         |       |           | X       |

### **Segmentation Strategies**

#### ABC Classification

ABC classification is an business analysis technique that categorizes
items (like products, customers, or suppliers) based on their relative
contribution of a value. It facilities the Pareto Principle (the 80/20
rule), suggesting that a small percentage of items contribute to the
largest percentage of the total value

The analysis will assign a letter category to each break point so that
you can further focus your analysis

#### Cohort

Cohort analysis is a type of behavioral analytics that takes data from a
given group of users (a cohort) and tracks their activity over time. A
cohort is typically defined by a shared starting characteristic, most
commonly the time period in which the entities first interacted with the
product or service

This allows you to understand retention, turnover and other attributes
more clearly

| Function | Description                                                                              | Categorizes | Time-Based | Tracks Over Time |
|----------|------------------------------------------------------------------------------------------|-------------|------------|------------------|
| abc()    | ABC Classification groups items by relative contribution (Pareto analysis).              | X           |            |                  |
| cohort() | Cohort analysis groups entities by a shared start point and analyzes behavior over time. |             | X          | X                |

------------------------------------------------------------------------

### **Factor / Variation Analysis**

Breaks down revenue or cost changes into **price, volume, and mix
effects**.

------------------------------------------------------------------------

## Future capabilities

Is there a future capability that you want to see here? please open up a
[discussion](https://github.com/usrbinr/fpaR/discussions) on our github
site

## Additional references and inspirations

- [PeerChristensen’s Cohort
  Package](https://github.com/PeerChristensen/cohorts)

------------------------------------------------------------------------

1.  I plan to use [duckplyr](https://duckplyr.tidyverse.org/index.html)
    once it expands support for lubricate functions

# Package index

## Utilities

General helper and execution utilities.

- [`augment_calendar()`](https://usrbinr.github.io/fpaR/reference/augment_calendar.md)
  : Add Comprehensive Date-Based Attributes to a DBI lazy frame or
  tibble object
- [`calculate`](https://usrbinr.github.io/fpaR/reference/calculate.md) :
  Execute time-intelligence or segments class objects to return the
  underlying transformed table

## Cohort & Classification

Functions for segmentation and cohort analysis.

- [`cohort()`](https://usrbinr.github.io/fpaR/reference/cohort.md) :
  Cohort Analysis
- [`abc()`](https://usrbinr.github.io/fpaR/reference/abc.md) : ABC
  classification function

## Monthly Functions

- [`mtd()`](https://usrbinr.github.io/fpaR/reference/mtd.md) : Current
  period month-to-date
- [`pmtd()`](https://usrbinr.github.io/fpaR/reference/pmtd.md) :
  Previous period month-to-date
- [`mom()`](https://usrbinr.github.io/fpaR/reference/mom.md) : Current
  full period month over previous full period month
- [`momtd()`](https://usrbinr.github.io/fpaR/reference/momtd.md) :
  Current period month to date compared to previous period month-to-date
- [`mtdopm()`](https://usrbinr.github.io/fpaR/reference/mtdopm.md) :
  Current month-to-date over full previous period month

## Quarterly Functions

- [`qtd()`](https://usrbinr.github.io/fpaR/reference/qtd.md) : Current
  period quarter-to-date
- [`pqtd()`](https://usrbinr.github.io/fpaR/reference/pqtd.md) : Prior
  period quarter-to-date
- [`qoq()`](https://usrbinr.github.io/fpaR/reference/qoq.md) : Current
  full period quarter over previous full period quarter
- [`qoqtd()`](https://usrbinr.github.io/fpaR/reference/qoqtd.md) :
  Current period quarter-to-date compared to previous period
  quarter-to-date
- [`qtdopq()`](https://usrbinr.github.io/fpaR/reference/qtdopq.md) :
  Current period quarter-to-date over previous period quarter

## Weekly Functions

- [`wtd()`](https://usrbinr.github.io/fpaR/reference/wtd.md) : Current
  period week-to-date
- [`pwtd()`](https://usrbinr.github.io/fpaR/reference/pwtd.md) :
  Previous period week-to-date
- [`wow()`](https://usrbinr.github.io/fpaR/reference/wow.md) : Current
  full period week over full previous period week
- [`wowtd()`](https://usrbinr.github.io/fpaR/reference/wowtd.md) :
  Current period Wwek-to-date over previous period week-to-date
- [`wtdopw()`](https://usrbinr.github.io/fpaR/reference/wtdopw.md) :
  Current period week-to-date over full previous period week
- [`dod()`](https://usrbinr.github.io/fpaR/reference/dod.md) : Current
  period day over previous period day

## Yearly & All of time Functions

- [`atd()`](https://usrbinr.github.io/fpaR/reference/atd.md) : All
  period-to-date
- [`ytd()`](https://usrbinr.github.io/fpaR/reference/ytd.md) : Current
  period year-to-date
- [`pytd()`](https://usrbinr.github.io/fpaR/reference/pytd.md) :
  Previous period year-to-date
- [`yoy()`](https://usrbinr.github.io/fpaR/reference/yoy.md) : Current
  full period year over previous full period year
- [`yoytd()`](https://usrbinr.github.io/fpaR/reference/yoytd.md) :
  Current period year-to-date compared to previous period year-to-date
- [`ytdopy()`](https://usrbinr.github.io/fpaR/reference/ytdopy.md) :
  Current period year-to-date compared to full previous period

# Articles

### All vignettes

- [ABC Segmentation](https://usrbinr.github.io/fpaR/articles/abc.md):
- [Standard vs. 5-5-4
  Calendar](https://usrbinr.github.io/fpaR/articles/calendar_types.md):
- [cohort](https://usrbinr.github.io/fpaR/articles/cohort.md):
- [Getting
  started](https://usrbinr.github.io/fpaR/articles/getting_started_with_ti.md):
