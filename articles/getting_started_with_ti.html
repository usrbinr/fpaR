<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started • fpaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="getting_started_with_ti_files/libs/quarto-html/popper.min.js"></script><script src="getting_started_with_ti_files/libs/quarto-html/tippy.umd.min.js"></script><link href="getting_started_with_ti_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="getting_started_with_ti_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fpaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/abc.html">ABC Segmentation</a></li>
    <li><a class="dropdown-item" href="../articles/calendar_types.html">Standard vs. 5-5-4 Calendar</a></li>
    <li><a class="dropdown-item" href="../articles/cohort.html">cohort</a></li>
    <li><a class="dropdown-item" href="../articles/getting_started_with_ti.html">Getting started</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/usrbinr"><span class="fa fab fa-github"></span> GitHub</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/usrbinr.bsky.social"><span class="fa fab fa-bluesky"></span> Bluesky</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started</h1>
      <p class="subtitle">How to use time-intilligence functions</p>




      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level3"><h3 id="how-to-use-fpar">How to use fpaR?<a class="anchor" aria-label="anchor" href="#how-to-use-fpar"></a>
</h3>
<section class="level3"><h4 id="time-intelligence">Time Intelligence<a class="anchor" aria-label="anchor" href="#time-intelligence"></a>
</h4>
<p>When you execute a time intelligence function, it will return a “ti” class object with a custom print method that explains what the function is doing and a summary of transformation steps and the calendar attributes.</p>
<p>Simply pass your data in either tibble or a lazy DBI object to the time intelligence function and input the required arguments.</p>
<blockquote>
<p>Regardless if you pass a tibble or lazy DBI object, all time intelligence functions will return a lazy DBI object for performance reasons</p>
</blockquote>
<p>We will use <code><a href="../reference/mtd.html">mtd()</a></code> function to calculate the month-to-date sum of contoso’s company’ revenue (<code><a href="https://usrbinr.github.io/contoso/reference/sales.html" class="external-link">contoso::sales</a></code>).</p>
<p>Most time intelligence functions follow the same structure:</p>
<ul>
<li>specify the date column to index the time intelligence functions</li>
<li>specify the value column to aggregate</li>
<li>if there is a period rollback / rollforward then clarify the number of periods</li>
<li>clarify if we are using a “standard” calendar or non-standard variation (currently supports 5-5-4)</li>
</ul>
<p>When you execute <code><a href="../reference/mtd.html">mtd()</a></code>, your console return a <code>ti</code> object and will print a summary of the function’s actions, details the calendar’s attributes, describes the main transformation steps and lists out possible next actions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">contoso</span><span class="fu">::</span><span class="va"><a href="https://usrbinr.github.io/contoso/reference/sales.html" class="external-link">sales</a></span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">fpaR</span><span class="fu">::</span><span class="fu"><a href="../reference/mtd.html">mtd</a></span><span class="op">(</span>.date<span class="op">=</span><span class="va">order_date</span>,.value <span class="op">=</span> <span class="va">revenue</span>,calendar_type <span class="op">=</span> <span class="st">"standard"</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<pre class="fansi fansi-message"><code><span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Month-to-date</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────</span>
</code></pre>
<div class="cell-output cell-output-stderr">
<pre><code>Function: `mtd` was executed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<pre class="fansi fansi-message"><code>── <span style="font-weight: bold;">Description:</span> ──
</code></pre>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<pre class="fansi fansi-message"><code>This creates a daily `cumsum()` of the <span style="color: #00BBBB;">current month</span> <span style="color: #00BB00;">revenue</span> from the start of
the <span style="color: #BBBB00;">standard</span> calendar month to the end of the month
</code></pre>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<pre class="fansi fansi-message"><code>── <span style="font-weight: bold;">Calendar:</span> ──
</code></pre>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<pre class="fansi fansi-output"><code>• The calendar aggregated <span style="color: #FF55FF;">order_date</span> to the <span style="color: #BBBB00;">day</span> time unit
• A <span style="color: #FF5555;">standard</span> calendar is created with <span style="color: #00BB00;">0 groups</span>
• Calendar ranges from <span style="color: #55FF55;">2021-05-18</span> to <span style="color: #55FF55;">2024-04-20</span>
• <span style="color: #0000BB;">222</span> days were missing and replaced with 0
• New date column <span style="color: #FF5555;">date</span>, <span style="color: #FF5555;">year</span> and <span style="color: #FF5555;">month</span> was created from <span style="color: #FF55FF;">order_date</span>
</code></pre>
<pre class="fansi fansi-message"><code>── <span style="font-weight: bold;">Actions:</span> ──
</code></pre>
<pre class="fansi fansi-message"><code><span style="color: #00BB00;">✔</span>Aggregate <span style="color: #0000BB;">revenue</span>
</code></pre>
<pre class="fansi fansi-message"><code><span style="color: #BB0000;">✖</span>Shift
</code></pre>
<pre class="fansi fansi-message"><code><span style="color: #BB0000;">✖</span>Compare
</code></pre>
<pre class="fansi fansi-message"><code><span style="color: #BB0000;">✖</span>Proportion Of Total
</code></pre>
<pre class="fansi fansi-message"><code><span style="color: #BB0000;">✖</span>Count Distinct
</code></pre>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<pre class="fansi fansi-message"><code>── <span style="font-weight: bold;">Next Steps:</span> ──
</code></pre>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Use `calculate()` to return the results</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>────────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p>To return the results to a lazy tibble of results, pass the ti object through to <code><a href="../reference/calculate.html">calculate()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">contoso</span><span class="fu">::</span><span class="va"><a href="https://usrbinr.github.io/contoso/reference/sales.html" class="external-link">sales</a></span> <span class="op">|&gt;</span>                                                          </span>
<span>   <span class="fu">fpaR</span><span class="fu">::</span><span class="fu"><a href="../reference/mtd.html">mtd</a></span><span class="op">(</span>.date<span class="op">=</span><span class="va">order_date</span>,.value <span class="op">=</span> <span class="va">margin</span>,calendar_type <span class="op">=</span> <span class="st">"standard"</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>   <span class="fu">fpaR</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span><span class="op">)</span>                                                          </span></code></pre></div>
</div>
<p>If you using a tibble, under the hood, <code>fpaR</code> is converting your data to a <a href="https://github.com/duckdb/duckdb-r" class="external-link">duckdb</a> database.</p>
<p>If your data is in a database, the package will leverage <a href="https://dbplyr.tidyverse.org/" class="external-link">dbplyr</a> to execute all the calculations.</p>
<p>Either case use <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code> to return your results to a local tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">contoso</span><span class="fu">::</span><span class="va"><a href="https://usrbinr.github.io/contoso/reference/sales.html" class="external-link">sales</a></span> <span class="op">|&gt;</span>                                                                </span>
<span>   <span class="fu">fpaR</span><span class="fu">::</span><span class="fu"><a href="../reference/mtd.html">mtd</a></span><span class="op">(</span>.date<span class="op">=</span><span class="va">order_date</span>,.value <span class="op">=</span> <span class="va">margin</span>,calendar_type <span class="op">=</span> <span class="st">"standard"</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>   <span class="fu">fpaR</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                                                       </span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                                               </span>
<span>   <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;"># A tibble: 10 × 7</span>
    year month date       margin missing_date_indicator mtd_margin
   <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #555555; font-style: italic;">&lt;date&gt;</span>      <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #555555; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #555555;"> 1</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-01      0                      1          0
<span style="color: #555555;"> 2</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-02      0                      1          0
<span style="color: #555555;"> 3</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-03      0                      1          0
<span style="color: #555555;"> 4</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-04      0                      1          0
<span style="color: #555555;"> 5</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-05      0                      1          0
<span style="color: #555555;"> 6</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-06      0                      1          0
<span style="color: #555555;"> 7</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-07      0                      1          0
<span style="color: #555555;"> 8</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-08      0                      1          0
<span style="color: #555555;"> 9</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-09      0                      1          0
<span style="color: #555555;">10</span>  <span style="text-decoration: underline;">2</span>022     4 2022-04-10      0                      1          0
<span style="color: #555555;"># ℹ 1 more variable: days_in_current_period &lt;dbl&gt;</span>
</code></pre>
</div>
</section><section class="level3"><h4 id="what-if-you-need-the-analysis-at-the-group-level">What if you need the analysis at the group level?<a class="anchor" aria-label="anchor" href="#what-if-you-need-the-analysis-at-the-group-level"></a>
</h4>
<p>Simply pass through the groups that you want with <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code> and time intelligence function will create a custom calendar for each group level.</p>
<p>This will calculate a complete calendar ensuring each group has a complete calendar with no missing dates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">contoso</span><span class="fu">::</span><span class="va"><a href="https://usrbinr.github.io/contoso/reference/sales.html" class="external-link">sales</a></span> <span class="op">|&gt;</span>   </span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">customer_key</span>,<span class="va">store_key</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>   <span class="fu">fpaR</span><span class="fu">::</span><span class="fu"><a href="../reference/yoy.html">yoy</a></span><span class="op">(</span>.date<span class="op">=</span><span class="va">order_date</span>,.value <span class="op">=</span> <span class="va">margin</span>,calendar_type <span class="op">=</span> <span class="st">"standard"</span><span class="op">)</span> </span></code></pre></div>
</div>
<p>The functions will work with your database even if you don’t have write permission by creatively leveraging CTEs to create interim tables.</p>
</section></section><section class="section level3"><h3 id="why-do-we-need-this-package-when-we-have-lubridate">Why do we need this package when we have lubridate?<a class="anchor" aria-label="anchor" href="#why-do-we-need-this-package-when-we-have-lubridate"></a>
</h3>
<p><a href="https://lubridate.tidyverse.org/" class="external-link">Lubridate</a> is an excellent package and is heavily used by the package. The issue isn’t lubridate but rather issues you may not be aware of in your package.</p>
<p>Time-based comparisons, such as Year-over-Year (YoY), Quarter-over-Quarter (QoQ), and Month-to-Date (MTD), are common for tracking business performance. However, they come with challenges:</p>
<ul>
<li><p>Many datasets <strong>do not have continuous dates</strong>, especially if data is recorded only on business days or for active transactions</p></li>
<li><p>Period imbalances between periods (Eg. the different number of days between February vs. January) can create misleading analysis or trends</p></li>
<li><p>Your analysis may need to reference a non-standard calendar such as a 5-5-4, 4-4-5, or 13 month calendar</p></li>
<li><p>Your data may be in excel sheets, csv or databases and you need to inter-operable framework to switch between all your data types</p></li>
</ul>
<section class="level3"><h4 id="issue-1-continuous-dates">Issue 1: Continuous Dates<a class="anchor" aria-label="anchor" href="#issue-1-continuous-dates"></a>
</h4>
<p>Referencing the <a href="#tbl-missing-dates-issues-1" class="quarto-xref">Table 1</a> below, if we were use <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">dplyr::lag()</a></code> to compare <strong>Day-over-Day (DoD)</strong> margin, we would be missing <code>2024-01-02</code>, <code>2024-01-04</code>, and <code>2024-01-05</code> which would lead to incorrect answers or trends.</p>
<div class="cell">
<div id="tbl-missing-dates-issues-1" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-missing-dates-issues-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1: Incomplete calendar table can lead to wrong conclusions or trends
</figcaption><div aria-describedby="tbl-missing-dates-issues-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script src="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js"></script><script>
      // Create table-specific functions using external factory
      const tableFns_lfb2kaov0rlcdplz295d = TinyTable.createTableFunctions("tinytable_lfb2kaov0rlcdplz295d");
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '7', j: 1 }, { i: '7', j: 2 } ], css_id: 'tinytable_css_2oo6a65ejn05gzhutu9d',},
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 } ], css_id: 'tinytable_css_psugpvf7etsirmuk4jok',},
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  tableFns_lfb2kaov0rlcdplz295d.styleCell(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css">
<style>
    /* tinytable css entries after */
    #tinytable_lfb2kaov0rlcdplz295d td.tinytable_css_2oo6a65ejn05gzhutu9d, #tinytable_lfb2kaov0rlcdplz295d th.tinytable_css_2oo6a65ejn05gzhutu9d {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    #tinytable_lfb2kaov0rlcdplz295d td.tinytable_css_psugpvf7etsirmuk4jok, #tinytable_lfb2kaov0rlcdplz295d th.tinytable_css_psugpvf7etsirmuk4jok {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    </style>
<div class="container">
      <table class="table tinytable" id="tinytable_lfb2kaov0rlcdplz295d" style="table-layout: fixed; width: 70% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col" data-row="0" data-col="1">date</th>
                <th scope="col" data-row="0" data-col="2">margin</th>
              </tr></thead>
<tbody>
<tr>
<td data-row="1" data-col="1">2024-01-01</td>
                  <td data-row="1" data-col="2">1200</td>
                </tr>
<tr>
<td data-row="2" data-col="1">2024-01-03</td>
                  <td data-row="2" data-col="2">1100</td>
                </tr>
<tr>
<td data-row="3" data-col="1">2024-01-06</td>
                  <td data-row="3" data-col="2">1300</td>
                </tr>
<tr>
<td data-row="4" data-col="1">2024-01-07</td>
                  <td data-row="4" data-col="2">900</td>
                </tr>
<tr>
<td data-row="5" data-col="1">2024-01-08</td>
                  <td data-row="5" data-col="2">1200</td>
                </tr>
<tr>
<td data-row="6" data-col="1">2024-01-09</td>
                  <td data-row="6" data-col="2">850</td>
                </tr>
<tr>
<td data-row="7" data-col="1">2024-01-11</td>
                  <td data-row="7" data-col="2">1450</td>
                </tr>
</tbody>
</table>
</div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>To correct this, <code>fpaR</code> will automatically complete your calendar for each group for the missing periods to ensure there are no missing periods when calculating trends.</p>
<p>In <a href="#tbl-missing-dates-issue-1-fix-no-echo" class="quarto-xref">Table 2</a> we see a complete calendar set and a new column, “missing_date_indicator” to indicate how many dates were missing.</p>
<div class="cell">
<div id="tbl-missing-dates-issue-1-fix-no-echo" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-missing-dates-issue-1-fix-no-echo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 2: Original table now complete with missing dates and a missing date indicator
</figcaption><div aria-describedby="tbl-missing-dates-issue-1-fix-no-echo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script src="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js"></script><script>
      // Create table-specific functions using external factory
      const tableFns_kwc90lbcap57ozwoww44 = TinyTable.createTableFunctions("tinytable_kwc90lbcap57ozwoww44");
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '11', j: 1 }, { i: '11', j: 2 }, { i: '11', j: 3 } ], css_id: 'tinytable_css_ufy2pxza65c6l2flsvau',},
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 } ], css_id: 'tinytable_css_gcqkd82hvzfeizmyqh17',},
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  tableFns_kwc90lbcap57ozwoww44.styleCell(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css">
<style>
    /* tinytable css entries after */
    #tinytable_kwc90lbcap57ozwoww44 td.tinytable_css_ufy2pxza65c6l2flsvau, #tinytable_kwc90lbcap57ozwoww44 th.tinytable_css_ufy2pxza65c6l2flsvau {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    #tinytable_kwc90lbcap57ozwoww44 td.tinytable_css_gcqkd82hvzfeizmyqh17, #tinytable_kwc90lbcap57ozwoww44 th.tinytable_css_gcqkd82hvzfeizmyqh17 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    </style>
<div class="container">
      <table class="table tinytable" id="tinytable_kwc90lbcap57ozwoww44" style="table-layout: fixed; width: 70% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col" data-row="0" data-col="1">date</th>
                <th scope="col" data-row="0" data-col="2">margin</th>
                <th scope="col" data-row="0" data-col="3">missing_date_indicator</th>
              </tr></thead>
<tbody>
<tr>
<td data-row="1" data-col="1">2024-01-01</td>
                  <td data-row="1" data-col="2">1200</td>
                  <td data-row="1" data-col="3">0</td>
                </tr>
<tr>
<td data-row="2" data-col="1">2024-01-02</td>
                  <td data-row="2" data-col="2">0</td>
                  <td data-row="2" data-col="3">1</td>
                </tr>
<tr>
<td data-row="3" data-col="1">2024-01-03</td>
                  <td data-row="3" data-col="2">1100</td>
                  <td data-row="3" data-col="3">0</td>
                </tr>
<tr>
<td data-row="4" data-col="1">2024-01-04</td>
                  <td data-row="4" data-col="2">0</td>
                  <td data-row="4" data-col="3">1</td>
                </tr>
<tr>
<td data-row="5" data-col="1">2024-01-05</td>
                  <td data-row="5" data-col="2">0</td>
                  <td data-row="5" data-col="3">1</td>
                </tr>
<tr>
<td data-row="6" data-col="1">2024-01-06</td>
                  <td data-row="6" data-col="2">1300</td>
                  <td data-row="6" data-col="3">0</td>
                </tr>
<tr>
<td data-row="7" data-col="1">2024-01-07</td>
                  <td data-row="7" data-col="2">900</td>
                  <td data-row="7" data-col="3">0</td>
                </tr>
<tr>
<td data-row="8" data-col="1">2024-01-08</td>
                  <td data-row="8" data-col="2">1200</td>
                  <td data-row="8" data-col="3">0</td>
                </tr>
<tr>
<td data-row="9" data-col="1">2024-01-09</td>
                  <td data-row="9" data-col="2">850</td>
                  <td data-row="9" data-col="3">0</td>
                </tr>
<tr>
<td data-row="10" data-col="1">2024-01-10</td>
                  <td data-row="10" data-col="2">0</td>
                  <td data-row="10" data-col="3">1</td>
                </tr>
<tr>
<td data-row="11" data-col="1">2024-01-11</td>
                  <td data-row="11" data-col="2">1450</td>
                  <td data-row="11" data-col="3">0</td>
                </tr>
</tbody>
</table>
</div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section></section><section class="section level3"><h3 id="issue-2-period-imbalances">Issue 2: Period imbalances<a class="anchor" aria-label="anchor" href="#issue-2-period-imbalances"></a>
</h3>
<p>When comparing two performance periods with a standard calendar, you often will compare a period with unequal number of days or periods. For example if you want to compare January sales to February you can get misleading conclusions due to the unequal number of weekends and days in those periods.</p>
<blockquote>
<p>In practice you have two choices:</p>
<ul>
<li><p>compare periods with similar days (eg. the 28th of February compares should only compare up to the 28th of January) and you omit three days of January sales all together</p></li>
<li><p>compare have an imbalanced comparison (eg. the 28th of February compares to the 31st of January so that no days are lost).</p></li>
</ul>
</blockquote>
<p>this package does the second option which is ensure we don’t loose any of January’s sales but to help flag for imbalance, fpaR will add a column to let you know how many periods (eg. days) are in your comparison period to increase transparency to this dynamic.</p>
<p>To create this example, we will use the <code><a href="../reference/pmtd.html">pmtd()</a></code> function to calculate the prior month to date cumulative margin in the current month.</p>
<p>When we pass the ti object through to <code><a href="../reference/calculate.html">calculate()</a></code> and filter the results for February 2022, we would see the below <a href="#tbl-issue2-example-no-echo" class="quarto-xref">Table 3</a>.</p>
<p>On 2022-02-28, we see that is comparing 31 days of the previous period to the 28 days in the current period.</p>
<div class="cell">
<div id="tbl-issue2-example-no-echo" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-issue2-example-no-echo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 3
</figcaption><div aria-describedby="tbl-issue2-example-no-echo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script src="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js"></script><script>
      // Create table-specific functions using external factory
      const tableFns_onwq5rj6c6h1czx9njlu = TinyTable.createTableFunctions("tinytable_onwq5rj6c6h1czx9njlu");
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '3', j: 1 }, { i: '3', j: 2 }, { i: '3', j: 3 }, { i: '3', j: 4 }, { i: '3', j: 5 } ], css_id: 'tinytable_css_xpsyb4mtz04aydtuxxun',},
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 } ], css_id: 'tinytable_css_0pekw6wmueyypyw0xbqv',},
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  tableFns_onwq5rj6c6h1czx9njlu.styleCell(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css">
<style>
    /* tinytable css entries after */
    #tinytable_onwq5rj6c6h1czx9njlu td.tinytable_css_xpsyb4mtz04aydtuxxun, #tinytable_onwq5rj6c6h1czx9njlu th.tinytable_css_xpsyb4mtz04aydtuxxun {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    #tinytable_onwq5rj6c6h1czx9njlu td.tinytable_css_0pekw6wmueyypyw0xbqv, #tinytable_onwq5rj6c6h1czx9njlu th.tinytable_css_0pekw6wmueyypyw0xbqv {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    </style>
<div class="container">
      <table class="table tinytable" id="tinytable_onwq5rj6c6h1czx9njlu" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col" data-row="0" data-col="1">date</th>
                <th scope="col" data-row="0" data-col="2">year</th>
                <th scope="col" data-row="0" data-col="3">month</th>
                <th scope="col" data-row="0" data-col="4">pmtd_margin</th>
                <th scope="col" data-row="0" data-col="5">days_in_comparison_period</th>
              </tr></thead>
<tbody>
<tr>
<td data-row="1" data-col="1">2022-02-26</td>
                  <td data-row="1" data-col="2">2022</td>
                  <td data-row="1" data-col="3">2</td>
                  <td data-row="1" data-col="4">129436.2</td>
                  <td data-row="1" data-col="5">26</td>
                </tr>
<tr>
<td data-row="2" data-col="1">2022-02-27</td>
                  <td data-row="2" data-col="2">2022</td>
                  <td data-row="2" data-col="3">2</td>
                  <td data-row="2" data-col="4">132202.3</td>
                  <td data-row="2" data-col="5">27</td>
                </tr>
<tr>
<td data-row="3" data-col="1">2022-02-28</td>
                  <td data-row="3" data-col="2">2022</td>
                  <td data-row="3" data-col="3">2</td>
                  <td data-row="3" data-col="4">142668.5</td>
                  <td data-row="3" data-col="5">31</td>
                </tr>
</tbody>
</table>
</div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section><section class="section level3"><h3 id="what-is-going-on-under-the-hood">what is going on under the hood<a class="anchor" aria-label="anchor" href="#what-is-going-on-under-the-hood"></a>
</h3>
<p>In financial planning and analysis, it is common to compare <strong>year-to-date (YTD)</strong> metrics against the <strong>previous year’s YTD</strong> to understand performance trends.</p>
<p>The function <code><a href="../reference/yoytd_fn.html">yoytd_fn()</a></code> provides this functionality. While it is an <strong>internal, non-exported function</strong>, it is called by [yoytd()] and executed through [calculate()].</p>
<p>This vignette explains what the function does, how it works, and how to work with its output.</p>
</section><section class="section level2"><h2 id="function-purpose">Function Purpose<a class="anchor" aria-label="anchor" href="#function-purpose"></a>
</h2>
<p><code><a href="../reference/yoytd_fn.html">yoytd_fn()</a></code> performs the following:</p>
<ol type="1">
<li>Computes <strong>current year-to-date (YTD)</strong> values.</li>
<li>Computes <strong>previous year-to-date (PYTD)</strong> values, optionally applying a lag.</li>
<li>Joins YTD and PYTD tables together on <code>date</code>, <code>year</code>, and grouping variables.</li>
<li>Fills missing dates downward for consistency.</li>
<li>Summarizes the data by summing the YTD and PYTD values by group.</li>
</ol>
<p>The output is a <strong>DBI object</strong> that can be converted into a <strong>tibble</strong> using <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code> for further analysis.</p>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alejandro Hagan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
