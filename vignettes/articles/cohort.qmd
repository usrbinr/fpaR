---
title: "Cohort"
author: "Alejandro Hagan"
subtitle: "What is cohort analysis and how to use it?"
---
```{r}
#| echo: false

quarto::write_yaml_metadata_block(
   date=format(Sys.Date())
   )
```


Cohort analysis is a common method for tracking groups of users, customers, or entities over time to understand retention, behavior, or trends.  

The `cohort()` function in **fpaR** provides a **tibble and database-friendly implementation** of cohort analysis that is compatible with `duckdb` and `snowflake` backends.

## How does it work?

`cohort()`:

- Assigns each member in your dataset to a **time-based cohort** based on the first occurrence in the `.date` column.
- Aggregates distinct counts of cohort members over time.
- Supports multiple calendar types (`"standard"` or a non-standard calendar `"544"`).
- Can summarize cohorts by various `time_unit`s (`day`, `week`, `month`, `quarter`, `year`).
- Returns a **segment object**, which can be processed using `calculate()` to generate the cohort table.

# Arguments

| Argument | Description |
|----------|-------------|
| `.data` | A `tibble` or DBI object containing your dataset. |
| `.date` | The date column to base the cohort assignment on. |
| `.value` | The column representing members to track (e.g., customer ID). |
| `calendar_type` | Type of calendar to use for aggregation: `"standard"` or `"554"`. |
| `time_unit` | Time unit to summarize the cohort table by (`day`, `week`, `month`, `quarter`, `year`). Default is `"month"`. |
| `period_label` | Whether to use numeric period labels (`TRUE`) or actual dates (`FALSE`). Default is `FALSE`. |


# Output

The function returns a **segment_cohort** object. Use `calculate()` to retrieve the cohort table:

```{r}
#|eval: false
library(dplyr)

# Example cohort analysis
fpaR::cohort(.data = contoso::sales,
                  .date = order_date,
                  .value = customer_key,
                  calendar_type = "standard",
                  time_unit = "month",
                  period_label = FALSE
             )

```

This function is basically a database translation of [PeerChristensen](https://github.com/PeerChristensen/cohorts) cohort package

